---
title: "Neural Network"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Neural Network}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r knit-options, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Run a neural network with default settings

## Import data and libraries
```{r setup, warning=FALSE, message=FALSE}
library(tiDML)
library(dplyr)
library(recipes)
library(parsnip)
```
Import the first 500 rows of the diamonds data from `ggplot2`.

```{r import-data}
df <- diamonds_sample(n=500)
```

# Neural network with default settings
```{r nnet-default, evaluate=FALSE}
fit_nnet <- dml_nnet(
  data = df,
  y = "price",
  d = "is_rated_ideal",
  x = c("carat", "depth", "table", "x", "y", "z"),
)
```

# Run a neural network with custom settings

It's possible to customise the default dml_nnet() to some degree. Here I set a custom penalty rate, number of epochs, and maximum number of weights. 

I also choose the number of layers (**not yet true, currently it's single layer**) and hidden units (nodes per layer) . Setting hidden units to `NULL` will let the function choose the number of hidden units automatically.


```{r nnet-custom}
fit_nnet <- dml_nnet(
  data = df,
  y = "price",
  d = "is_rated_ideal",
  x = c("carat", "depth", "table", "x", "y", "z"),
  n_folds = 5,
  n_rep = 3,
  vcov_type = "HC2",
  hidden_units_m = 6,
  hidden_units_g = 7,
  penalty = 0.001,
  epochs = 200,
  max_weights = 5000,
  trace = FALSE  
)

fit_nnet |> tidy()
```

