---
title: "Introduction to tiDML"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to tiDML}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r knit-options, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
# First pass with tiDML

In the simplest case, you can use the package under complete default settings. Pick a model, specify data, outcome variable, treatment variable, and covariates, and hit go. Currently, the default models available are:
+ `dml_rf()` for random forest, and
+ `dml_nnet()` for a neural network.

Here I use the `diamonds` data from `ggplot2` to estimate the effect of being rated "ideal" on a diamonds price, after having controlled for caret, depth, etc.


```{r simple}
library(tiDML)
library(generics)

df <- diamonds_sample()

fit_rf <- dml_rf(
  data = df,
  y = "price",
  d = "is_rated_ideal",
  x = c("carat", "depth", "table", "x", "y", "z"),
)

tidy(fit_rf)
```
The function `dml_rf` is a shortcut for using the `ranger` package to fit random forest models. The full list of options is:
+ `dml_rf()` for a random forest model using `ranger()`, and
+ `dml_nnet()` for a neural network model using `mlp()`.

Printing out the recipe steps of the DML estimate shows the preprocessing steps that was automatically applied to the data before fitting the nuisance models. In this case of `dml_nn()`, we see: 
+ zero variance filtering,
+ Median imputation for missing values,
+ Dummy encoding for categorical variables, and
+ Centering and scaling of numeric variables.

```{r show-recipe}
print("hello")
```

# Examining the output

Much more detail is giving in the Articles section of the documentation (see `vignette("examine-outputs")`).

To get a quick overview of the results, you can use the `tidy()` or `augment()` functions which will return, respectively:
+ a tibble with the point estimate, standard error, t-value, p-value, and confidence interval.
+ a tibble with the original data, predicted values, and residuals for the outcome and treatment variables.